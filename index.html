<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  
  <meta property="og:title" content="สมัครสมาชิก VIP - Spaghetti Factory">
  <meta property="og:description" content="ลงทะเบียนวันนี้ รับสิทธิพิเศษและส่วนลดมากมายเฉพาะสมาชิก VIP เท่านั้น!">
  <meta property="og:image" content="logo.png">
  
  <title>Spaghetti Factory VIP Register</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    /* ตั้งค่า Font หลัก และสีพื้นหลัง */
    body { font-family: 'Kanit', sans-serif; }
    
    /* UX: ป้องกันการซูมบนมือถือเวลาจิ้ม Input (เฉพาะ iOS) */
    input, textarea { font-size: 16px !important; }

    /* Custom Scrollbar ให้ดูสะอาดตา */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #f1f1f1; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

    .brand-color { color: #005C5C; }
    
    /* Checkbox Styles: ปรับแต่ง Checkbox ให้เข้ากับธีม */
    .checkbox-wrapper input:checked + div { background-color: #005C5C; border-color: #005C5C; }
    .checkbox-wrapper input:checked + div svg { display: block; }
    
    /* Button States */
    .btn-disabled { background-color: #CBD5E1; cursor: not-allowed; transform: none !important; }
    .btn-active { 
        background-color: #005C5C; 
        cursor: pointer; 
        box-shadow: 0 4px 14px 0 rgba(0, 92, 92, 0.39); /* เพิ่มเงาให้ปุ่มดูมีมิติ */
    }
    .btn-active:hover { background-color: #004545; transform: translateY(-1px); }
    .btn-active:active { transform: scale(0.98); }

    /* Glassmorphism Card: ปรับ Shadow และ Border ให้ดูพรีเมียมขึ้น */
    .glass-card { 
        background: rgba(255, 255, 255, 0.90); 
        backdrop-filter: blur(12px); /* เบลอฉากหลังเพื่อให้ตัวหนังสือชัด */
        -webkit-backdrop-filter: blur(12px);
        box-shadow: 0 20px 40px -10px rgba(0, 92, 92, 0.15); 
        border-radius: 24px; 
        border: 1px solid rgba(255, 255, 255, 0.6); 
    }

    /* Pattern Background: สร้างพื้นหลังให้มีลวดลาย เพื่อให้ Glass Effect ทำงานได้สวย */
    .bg-pattern {
        background-color: #FDFBF7;
        background-image: radial-gradient(#005C5C 0.5px, transparent 0.5px), radial-gradient(#005C5C 0.5px, #FDFBF7 0.5px);
        background-size: 20px 20px;
        background-position: 0 0, 10px 10px;
        opacity: 1;
    }
    /* สร้าง Overlay สีจางๆ ทับ Pattern เพื่อไม่ให้ลายตาเกินไป */
    .bg-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(135deg, rgba(253, 251, 247, 0.9) 0%, rgba(230, 245, 245, 0.8) 100%);
        z-index: -1;
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4 bg-pattern relative">
  <div class="bg-overlay"></div>

  <div class="glass-card w-full max-w-md overflow-hidden relative animate-[fadeIn_0.5s_ease-out]">
    
    <div class="pt-8 pb-4 px-8 text-center relative z-10">
      <img src="logo.png" alt="Spaghetti Factory" class="h-20 mx-auto mb-4 object-contain drop-shadow-sm hover:scale-105 transition-transform duration-300">
      <h2 class="text-2xl font-bold brand-color tracking-tight">VIP Registration</h2>
      <p class="text-gray-500 text-sm mt-1 font-light">กรอกข้อมูลเพื่อรับสิทธิพิเศษสมาชิก</p>
    </div>

    <div class="px-8 pb-8">
      <form id="regForm" onsubmit="submitForm(event)" class="space-y-4">
        
        <div>
          <label class="text-xs font-semibold text-gray-500 uppercase ml-1 tracking-wider">Full Name *</label>
          <input type="text" name="fullName" required placeholder="ชื่อ-นามสกุล" autocomplete="name"
                 class="w-full mt-1 px-4 py-3 bg-white/50 border border-gray-200 rounded-xl text-gray-700 text-base focus:bg-white focus:ring-2 focus:ring-[#005C5C] focus:border-transparent outline-none transition-all duration-200 placeholder-gray-400">
        </div>

        <div>
            <label class="text-xs font-semibold text-gray-500 uppercase ml-1 tracking-wider">Phone Number *</label>
            <input type="tel" name="phone" required maxlength="10" placeholder="08xxxxxxxx" inputmode="numeric" autocomplete="tel"
                   class="w-full mt-1 px-4 py-3 bg-white/50 border border-gray-200 rounded-xl text-gray-700 text-base focus:bg-white focus:ring-2 focus:ring-[#005C5C] focus:border-transparent outline-none transition-all duration-200 placeholder-gray-400">
        </div>

        <div>
            <label class="text-xs font-semibold text-gray-500 uppercase ml-1 tracking-wider">Line ID <span class="text-gray-400 font-normal normal-case">(ไม่บังคับ)</span></label>
            <input type="text" name="lineId" placeholder="เช่น @myspaghetti"
                   class="w-full mt-1 px-4 py-3 bg-white/50 border border-gray-200 rounded-xl text-gray-700 text-base focus:bg-white focus:ring-2 focus:ring-[#005C5C] focus:border-transparent outline-none transition-all duration-200 placeholder-gray-400">
        </div>

        <div>
          <label class="text-xs font-semibold text-gray-500 uppercase ml-1 tracking-wider">Email *</label>
          <input type="email" name="email" required placeholder="name@email.com" inputmode="email" autocomplete="email"
                 class="w-full mt-1 px-4 py-3 bg-white/50 border border-gray-200 rounded-xl text-gray-700 text-base focus:bg-white focus:ring-2 focus:ring-[#005C5C] focus:border-transparent outline-none transition-all duration-200 placeholder-gray-400">
        </div>

        <div>
          <label class="text-xs font-semibold text-gray-500 uppercase ml-1 tracking-wider">Address *</label>
          <textarea name="address" required rows="3" placeholder="บ้านเลขที่, ถนน, แขวง/ตำบล, เขต/อำเภอ, จังหวัด, รหัสไปรษณีย์" autocomplete="street-address"
                    class="w-full mt-1 px-4 py-3 bg-white/50 border border-gray-200 rounded-xl text-gray-700 text-base focus:bg-white focus:ring-2 focus:ring-[#005C5C] focus:border-transparent outline-none resize-none transition-all duration-200 placeholder-gray-400"></textarea>
        </div>

        <div class="pt-2">
            <label class="checkbox-wrapper flex items-start cursor-pointer group">
              <input type="checkbox" id="pdpaCheck" class="hidden" onchange="toggleSubmitButton()">
              <div class="w-5 h-5 border-2 border-gray-300 rounded flex items-center justify-center mt-0.5 mr-3 transition-all duration-200 bg-white group-hover:border-[#005C5C] flex-shrink-0 shadow-sm">
                <svg class="w-3 h-3 text-white hidden pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
              </div>
              <div class="text-sm text-gray-500 select-none leading-tight pt-0.5">
                ข้าพเจ้าได้อ่านและยอมรับ <a href="#" onclick="showPDPA(event)" class="text-[#005C5C] font-semibold underline decoration-dotted hover:text-[#004545]">นโยบายความเป็นส่วนตัวและข้อตกลง</a>
              </div>
            </label>
        </div>

        <div class="pt-2">
          <button type="submit" id="submitBtn" disabled 
                  class="w-full btn-disabled text-white font-bold py-3.5 px-4 rounded-xl shadow-lg transition-all duration-300 flex justify-center items-center gap-2 text-base tracking-wide">
            <span>ยืนยันการลงทะเบียน</span>
          </button>
        </div>
      </form>
    </div>
    
    <div class="bg-gray-50/50 py-3 text-center border-t border-gray-100 backdrop-blur-sm">
      <p class="text-[10px] text-gray-400 font-light tracking-wider">© SPAGHETTI FACTORY VIP MEMBER</p>
    </div>
  </div>

  <script>
    // *** Config URL Script ***
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzwkwc-eu5UKXwKkm7TslEv0U11IKAyNK_pktxTw8dbA3aeJfdW6M6FWvq5J5ej9xUy/exec';

    /**
     * ฟังก์ชันควบคุมสถานะปุ่ม Submit
     * จะเปิดใช้งานก็ต่อเมื่อติ๊กถูกยอมรับ PDPA แล้วเท่านั้น
     */
    function toggleSubmitButton() {
        const checkbox = document.getElementById('pdpaCheck');
        const btn = document.getElementById('submitBtn');
        
        if (checkbox.checked) {
            btn.disabled = false;
            btn.classList.remove('btn-disabled');
            btn.classList.add('btn-active');
        } else {
            btn.disabled = true;
            btn.classList.add('btn-disabled');
            btn.classList.remove('btn-active');
        }
    }

    /**
     * ฟังก์ชันแสดง Popup PDPA
     * ใช้ SweetAlert2 เพื่อความสวยงามและ Responsive
     */
    function showPDPA(e) {
        e.preventDefault(); 
        Swal.fire({
            title: '<strong style="color:#005C5C; font-family: Kanit; font-size: 1.2em;">นโยบายความเป็นส่วนตัวและข้อตกลง</strong>',
            html: `
                <div style="text-align: left; font-size: 0.9rem; line-height: 1.6; color: #4B5563; font-family: Kanit;">
                    <p style="margin-bottom:10px; font-size:0.85rem; color:#6b7280;">โปรดอ่านข้อกำหนดการใช้ข้อมูลส่วนบุคคล</p>
                    
                    <div style="margin-bottom: 12px; display: flex; align-items: flex-start;">
                        <div style="min-width: 24px; color: #005C5C; font-weight: bold;">1.</div>
                        <div>บริษัทจะจัดเก็บ ชื่อ-ที่อยู่-เบอร์โทร เพื่อใช้ในการสมัครและมอบสิทธิประโยชน์</div>
                    </div>

                    <div style="margin-bottom: 12px; display: flex; align-items: flex-start;">
                        <div style="min-width: 24px; color: #005C5C; font-weight: bold;">2.</div>
                        <div>ยินยอมให้ติดต่อกลับเพื่อแจ้งข่าวสารโปรโมชั่น (ไม่ส่ง Spam รบกวน)</div>
                    </div>

                    <div style="margin-top: 15px; padding: 10px; background-color: #f0fdfa; border-radius: 8px; font-size: 0.8rem; color:#005C5C;">
                        ท่านสามารถยกเลิกความยินยอมได้ตลอดเวลาโดยติดต่อทางร้าน
                    </div>
                </div>
            `,
            confirmButtonText: 'ยอมรับเงื่อนไข',
            confirmButtonColor: '#005C5C',
            width: '90%', // Responsive width
            maxWidth: '500px',
            borderRadius: '16px',
            showCloseButton: true
        }).then((result) => {
            if (result.isConfirmed) {
                const checkbox = document.getElementById('pdpaCheck');
                checkbox.checked = true;
                toggleSubmitButton();
            }
        });
    }

    /**
     * ฟังก์ชันส่งข้อมูล
     * มีการ Validate เบอร์โทร และแสดง Loading State
     */
    function submitForm(e) {
      e.preventDefault();
      
      const form = document.getElementById('regForm');
      const phoneVal = form.phone.value.trim();

      // Validation: ตรวจสอบเบอร์โทร 10 หลัก (Regex)
      const phoneRegex = /^\d{10}$/;
      if (!phoneRegex.test(phoneVal)) {
        Swal.fire({
          icon: 'warning',
          title: 'เบอร์โทรศัพท์ไม่ถูกต้อง',
          text: 'กรุณากรอกเบอร์มือถือ 10 หลัก โดยไม่ต้องใส่ขีด (-)',
          confirmButtonColor: '#005C5C',
          confirmButtonText: 'แก้ไขข้อมูล'
        });
        return;
      }

      // UI: เปลี่ยนปุ่มเป็นสถานะ Loading
      const btn = document.getElementById('submitBtn');
      const originalText = btn.innerHTML;
      
      btn.innerHTML = `
        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        กำลังบันทึกข้อมูล...
      `;
      btn.disabled = true;
      btn.classList.add('opacity-80', 'cursor-wait');

      const formData = {
        fullName: form.fullName.value,
        phone: phoneVal,
        lineId: form.lineId.value,
        email: form.email.value,
        address: form.address.value
      };

      // API Call: ส่งข้อมูลไปยัง Google Script
      fetch(SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors', // no-cors สำหรับ Google Apps Script
        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
        body: JSON.stringify(formData)
      })
      .then(() => {
        // Success: แสดง Popup สำเร็จ
        Swal.fire({
          icon: 'success',
          title: 'ลงทะเบียนสำเร็จ!',
          text: 'ยินดีต้อนรับสู่ครอบครัว Spaghetti Factory',
          confirmButtonColor: '#005C5C',
          confirmButtonText: 'ตกลง'
        }).then(() => {
          form.reset();
          btn.innerHTML = originalText;
          btn.classList.remove('opacity-80', 'cursor-wait');
          toggleSubmitButton(); 
        });
      })
      .catch(error => {
        // Error: แจ้งเตือนเมื่อระบบมีปัญหา
        console.error('Error:', error);
        Swal.fire({ 
            icon: 'error', 
            title: 'เกิดข้อผิดพลาด', 
            text: 'ไม่สามารถเชื่อมต่อระบบได้ โปรดลองใหม่อีกครั้ง',
            confirmButtonColor: '#d33' 
        });
        btn.innerHTML = originalText;
        btn.classList.remove('opacity-80', 'cursor-wait');
        toggleSubmitButton();
      });
    }
  </script>
</body>
</html>