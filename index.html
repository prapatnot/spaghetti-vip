<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  
  <meta property="og:title" content="สมัครสมาชิก VIP - Spaghetti Factory">
  <meta property="og:description" content="ลงทะเบียนรับสิทธิพิเศษและส่วนลดมากมายเฉพาะสมาชิก VIP">
  <meta property="og:image" content="logo.png">
  
  <title>Spaghetti Factory VIP Register</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              DEFAULT: '#005C5C',
              dark: '#004545',
              light: '#E6F2F2',
              accent: '#FD8C5F' 
            }
          },
          fontFamily: {
            sans: ['Kanit', 'sans-serif'],
          }
        }
      }
    }
  </script>

  <style>
    /* UX Tweaks */
    body { 
        background-color: #F8FAFC;
        background-image: radial-gradient(#005C5C 0.8px, transparent 0.8px);
        background-size: 24px 24px;
    }
    
    /* Disable Zoom on iOS Inputs */
    input, textarea, select { font-size: 16px !important; }

    /* Glass Effect */
    .glass-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.8);
        box-shadow: 0 25px 50px -12px rgba(0, 92, 92, 0.15);
    }

    /* Input Styling */
    .input-group { position: relative; }
    .input-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: #94A3B8;
        transition: color 0.3s;
        pointer-events: none;
    }
    .custom-input {
        padding-left: 3rem !important; /* เว้นที่ให้ไอคอน */
        transition: all 0.3s ease;
    }
    .custom-input:focus {
        border-color: #005C5C;
        box-shadow: 0 0 0 4px rgba(0, 92, 92, 0.1);
    }
    .input-group:focus-within .input-icon { color: #005C5C; }

    /* Animation */
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .animate-enter { animation: fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

  <div class="glass-card w-full max-w-[420px] rounded-3xl overflow-hidden animate-enter relative">
    
    <div class="h-2 w-full bg-gradient-to-r from-brand to-teal-400"></div>

    <div class="pt-8 pb-2 px-8 text-center">
      <div class="relative w-24 h-24 mx-auto mb-4 bg-white rounded-full shadow-md flex items-center justify-center border border-gray-100 p-2">
        <img src="logo.png" alt="Spaghetti Factory" class="w-full h-full object-contain">
      </div>
      <h2 class="text-2xl font-bold text-brand tracking-tight">VIP Registration</h2>
      <p class="text-gray-500 text-sm mt-1">กรอกข้อมูลเพื่อรับสิทธิพิเศษ</p>
    </div>

    <div class="px-6 pb-8 pt-4">
      <form id="regForm" onsubmit="submitForm(event)" class="space-y-5">
        
        <div>
          <label class="block text-xs font-semibold text-gray-500 mb-1.5 ml-1">ชื่อ-นามสกุล <span class="text-red-500">*</span></label>
          <div class="input-group">
            <i class="fas fa-user input-icon"></i>
            <input type="text" name="fullName" required placeholder="ระบุชื่อจริงและนามสกุล" autocomplete="name"
                   class="custom-input w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 outline-none placeholder-gray-400">
          </div>
        </div>

        <div>
            <label class="block text-xs font-semibold text-gray-500 mb-1.5 ml-1">เบอร์โทรศัพท์ <span class="text-red-500">*</span></label>
            <div class="input-group">
              <i class="fas fa-mobile-alt input-icon"></i>
              <input type="tel" name="phone" id="phoneInput" required maxlength="12" placeholder="0xx-xxx-xxxx" inputmode="numeric" autocomplete="tel"
                     class="custom-input w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 outline-none placeholder-gray-400">
            </div>
        </div>

        <div>
            <label class="block text-xs font-semibold text-gray-500 mb-1.5 ml-1">Line ID <span class="text-gray-300 font-light">(ไม่บังคับ)</span></label>
            <div class="input-group">
              <i class="fab fa-line input-icon"></i>
              <input type="text" name="lineId" placeholder="@yourlineid"
                     class="custom-input w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 outline-none placeholder-gray-400">
            </div>
        </div>

        <div>
          <label class="block text-xs font-semibold text-gray-500 mb-1.5 ml-1">อีเมล <span class="text-red-500">*</span></label>
          <div class="input-group">
            <i class="fas fa-envelope input-icon"></i>
            <input type="email" name="email" required placeholder="name@example.com" inputmode="email" autocomplete="email"
                   class="custom-input w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 outline-none placeholder-gray-400">
          </div>
        </div>

        <div>
          <label class="block text-xs font-semibold text-gray-500 mb-1.5 ml-1">ที่อยู่จัดส่ง <span class="text-red-500">*</span></label>
          <div class="input-group">
            <i class="fas fa-map-marker-alt input-icon top-4 transform-none"></i>
            <textarea name="address" required rows="2" placeholder="บ้านเลขที่, ถนน, แขวง/ตำบล..." autocomplete="street-address"
                      class="custom-input w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 outline-none resize-none placeholder-gray-400 min-h-[80px]"></textarea>
          </div>
        </div>

        <div class="pt-2">
            <label class="flex items-start cursor-pointer group select-none">
              <div class="relative flex items-center">
                <input type="checkbox" id="pdpaCheck" class="peer sr-only" onchange="toggleSubmitButton()">
                <div class="w-5 h-5 border-2 border-gray-300 rounded peer-checked:bg-brand peer-checked:border-brand transition-all duration-200"></div>
                <div class="absolute inset-0 flex items-center justify-center text-white opacity-0 peer-checked:opacity-100 pointer-events-none transition-opacity">
                    <i class="fas fa-check text-xs"></i>
                </div>
              </div>
              <div class="ml-3 text-sm text-gray-500 leading-tight">
                ฉันยอมรับ <a href="#" onclick="showPDPA(event)" class="text-brand font-semibold underline decoration-dotted hover:text-teal-700">เงื่อนไขและนโยบายความเป็นส่วนตัว</a>
              </div>
            </label>
        </div>

        <div class="pt-2">
          <button type="submit" id="submitBtn" disabled 
                  class="w-full bg-gray-300 text-white font-bold py-4 rounded-xl shadow-none transition-all duration-300 transform scale-100 flex justify-center items-center gap-2
                         disabled:opacity-70 disabled:cursor-not-allowed
                         enabled:bg-gradient-to-r enabled:from-brand enabled:to-teal-600 enabled:shadow-lg enabled:shadow-teal-900/20 enabled:active:scale-[0.98]">
            <span>ยืนยันการลงทะเบียน</span>
            <i class="fas fa-arrow-right text-sm"></i>
          </button>
        </div>
      </form>
    </div>
    
    <div class="bg-gray-50 py-4 text-center border-t border-gray-100">
      <p class="text-[10px] text-gray-400 font-light tracking-wider uppercase">© Spaghetti Factory VIP Member</p>
    </div>
  </div>

  <script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzwkwc-eu5UKXwKkm7TslEv0U11IKAyNK_pktxTw8dbA3aeJfdW6M6FWvq5J5ej9xUy/exec';

    // --- Phone Formatter Logic ---
    const phoneInput = document.getElementById('phoneInput');
    phoneInput.addEventListener('input', function (e) {
        let x = e.target.value.replace(/\D/g, '').match(/(\d{0,3})(\d{0,3})(\d{0,4})/);
        e.target.value = !x[2] ? x[1] : x[1] + '-' + x[2] + (x[3] ? '-' + x[3] : '');
    });

    function toggleSubmitButton() {
        const checkbox = document.getElementById('pdpaCheck');
        const btn = document.getElementById('submitBtn');
        btn.disabled = !checkbox.checked;
    }

    /**
     * ฟังก์ชันแสดง Popup PDPA (อัปเดตข้อความใหม่ตามที่ขอ)
     */
    function showPDPA(e) {
        e.preventDefault(); 
        Swal.fire({
            title: '<span class="text-brand font-kanit">การขอความยินยอม (Consent)</span>',
            html: `
                <div class="text-left text-sm text-gray-600 font-kanit space-y-4 p-2">
                    <div class="flex gap-3 items-start">
                        <i class="far fa-check-square text-brand mt-1 text-lg flex-shrink-0"></i>
                        <span class="leading-relaxed">บริษัทจะเก็บรวบรวม ใช้ และจัดเก็บข้อมูลส่วนบุคคลของท่าน ได้แก่ ชื่อ–นามสกุล ที่อยู่ หมายเลขโทรศัพท์ และอีเมล เพื่อใช้ในการสมัครบัตรสมาชิก การให้สิทธิประโยชน์ และการติดต่อสื่อสารที่เกี่ยวข้องกับการเป็นสมาชิก</span>
                    </div>
                    <div class="flex gap-3 items-start">
                        <i class="far fa-check-square text-brand mt-1 text-lg flex-shrink-0"></i>
                        <span class="leading-relaxed">ข้าพเจ้ายินยอมให้บริษัทติดต่อกลับผ่านทางโทรศัพท์ อีเมล หรือช่องทางอื่นที่ข้าพเจ้าให้ไว้ เพื่อแจ้งข้อมูล สิทธิประโยชน์ ข่าวสาร หรือกิจกรรมที่เกี่ยวข้องกับบัตรสมาชิก</span>
                    </div>
                    <div class="flex gap-3 items-start">
                        <i class="far fa-check-square text-brand mt-1 text-lg flex-shrink-0"></i>
                        <span class="leading-relaxed">ท่านสามารถถอนความยินยอมได้ทุกเมื่อ โดยติดต่อบริษัทผ่านช่องทาง Line Official Account : @spaghettifactory โดยจะไม่กระทบต่อสิทธิประโยชน์ที่ได้รับก่อนการถอนความยินยอม</span>
                    </div>
                </div>
            `,
            confirmButtonText: 'ยอมรับข้อตกลง',
            confirmButtonColor: '#005C5C',
            width: '90%', 
            maxWidth: '500px',
            customClass: { popup: 'rounded-2xl' }
        }).then((result) => {
            if (result.isConfirmed) {
                document.getElementById('pdpaCheck').checked = true;
                toggleSubmitButton();
            }
        });
    }

    function submitForm(e) {
      e.preventDefault();
      
      const form = document.getElementById('regForm');
      // ลบขีดออกจากเบอร์โทรเพื่อส่งเฉพาะตัวเลข
      const rawPhone = form.phone.value.replace(/-/g, '');

      if (rawPhone.length !== 10) {
        Swal.fire({
          icon: 'warning',
          title: 'เบอร์โทรศัพท์ไม่ครบถ้วน',
          text: 'กรุณากรอกเบอร์มือถือ 10 หลัก',
          confirmButtonColor: '#005C5C'
        });
        return;
      }

      const btn = document.getElementById('submitBtn');
      const originalContent = btn.innerHTML;
      
      // Loading State
      btn.innerHTML = `<i class="fas fa-circle-notch fa-spin"></i> กำลังบันทึก...`;
      btn.disabled = true;

      const formData = {
        fullName: form.fullName.value,
        phone: rawPhone, // ส่งแบบไม่มีขีด
        lineId: form.lineId.value,
        email: form.email.value,
        address: form.address.value
      };

      fetch(SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
        body: JSON.stringify(formData)
      })
      .then(() => {
        Swal.fire({
          icon: 'success',
          title: 'ลงทะเบียนสำเร็จ!',
          text: 'ยินดีต้อนรับสู่ครอบครัว Spaghetti Factory',
          confirmButtonColor: '#005C5C',
          timer: 3000,
          timerProgressBar: true
        }).then(() => {
          form.reset();
          btn.innerHTML = originalContent;
          toggleSubmitButton(); 
        });
      })
      .catch(error => {
        console.error('Error:', error);
        Swal.fire({ icon: 'error', title: 'เกิดข้อผิดพลาด', text: 'กรุณาลองใหม่', confirmButtonColor: '#d33' });
        btn.innerHTML = originalContent;
        btn.disabled = false;
      });
    }
  </script>
</body>
</html>

```

